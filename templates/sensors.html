{% extends 'base.html' %}

{% block title %}Sensor Uitlezingen{% endblock %}

{% block content %}
  <h1>Sensor Uitlezingen</h1>

  <table>
    <thead>
      <tr>
        <th>Naam</th>
        <th>Slave ID</th>
        <th>Kanaal</th>
        <th>Ruwe Waarde</th>
        <th>Gekalibreerd</th>
      </tr>
    </thead>
    <tbody id="sensorBody">
      <!-- Wordt gevuld via WebSocket -->
    </tbody>
  </table>

  <script src="//cdnjs.cloudflare.com/ajax/libs/socket.io/4.5.0/socket.io.min.js"></script>
  <script>
    const socket = io('/sensors');

    socket.on('sensor_update', readings => {
      const tbody = document.getElementById('sensorBody');
      tbody.innerHTML = '';
      readings.forEach(r => {
        const tr = document.createElement('tr');
        ['name','slave_id','channel','raw','value'].forEach(key => {
          const td = document.createElement('td');
          td.textContent = r[key] != null ? r[key] : 'â€”';
          tr.appendChild(td);
        });
        tbody.appendChild(tr);
      });
    });
  </script>
{% endblock %}
